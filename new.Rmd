library(recommenderlab)
library(dplyr)
library(tidyr)
library(ggplot2)
#100K data source #http://files.grouplens.org/datasets/movielens/ml-100k
movie<-read.table("http://files.grouplens.org/datasets/movielens/ml-100k/u.data")
colnames(movie)<-c("users","items","rating","timestamp")
users<-read.table("http://files.grouplens.org/datasets/movielens/ml-100k/u.user",sep="|")
colnames(users)<-c("userid","age","gender","occupation","zipcode")
item<-read.delim("http://files.grouplens.org/datasets/movielens/ml-100k/u.item",sep="|",header=F)
item<-item[,c(-1,-3,-4,-5)]
colnames(item)<-c("MovieName","unknown", "Action","Adventure","Animation","Children", "Comedy" ,"Crime" ,"Documentary","Drama","Fantasy","Film-Noir","Horror","Musical","Mystery","Romance","Sci-Fi","Thriller","War","Western")
movies=movie[,c(1,2,3)]
movies=spread(movies,items,rating)
movies=movies[,-1]
class(movies)
movies<-as.matrix(movies)
ml<-as(movies, "realRatingMatrix")
ml
colnames(ml)<-as.character(c(1:dim(movies)[2]))
ml.recommModel <- Recommender(ml[1:800], method = "UBCF")
ml.predict1 <- predict(ml.recommModel, ml[901:903], n = 10)
d=as( ml.predict1, "list") 
item[as.numeric(d[[1]]),1]
item[as.numeric(d[[2]]),1]
item[as.numeric(d[[3]]),1]
data(MovieLense)
image(MovieLense)
